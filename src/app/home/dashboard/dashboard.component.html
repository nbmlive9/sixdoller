<div class="dashboard-container">

  <app-header></app-header>

  <!-- Main Body -->
  <section class="welcome-section">
    <h4>ðŸ‘‹ Welcome, <span>{{ pfdata?.name }}</span></h4>
        <h6>Joining Date: <span>{{ pfdata?.cdate | date:'dd/MM/YYYY' }}</span></h6>
    <p>{{pfdata?.regid}} ( <span *ngIf="runningBoard" class="text-warning">
    Board {{ runningBoard }} Running
  </span>)
    </p>
  </section>

  <!-- Share Section -->
<div class="share-section card p-3 mb-3 shadow-sm rounded-3 text-center">
  <h5 class="mb-3">Invite Friends & Earn Rewards!</h5>

  <!-- Referral Link Display -->
  <div class="referral-link mb-3 d-flex align-items-center justify-content-between">
    <p class="text-truncate mb-0" style="max-width: 70%;">
      https://yohanrise.com/yohan/referral/{{ pfdata?.regid }}
    </p>
    <button class="btn-copy" (click)="copyReferralLink()">
      <i class="fa fa-clone"></i>
    </button>
  </div>
  <p *ngIf="copiedLink" class="text-success small mt-2 mb-0">Copied!</p>

  <!-- Share Buttons -->
  <div class="share-buttons mt-3 d-flex justify-content-center flex-wrap gap-2">
    <button class="btn-share whatsapp" (click)="shareTo('whatsapp')">
      <i class="fab fa-whatsapp me-1"></i> WhatsApp
    </button>
    <button class="btn-share telegram" (click)="shareTo('telegram')">
      <i class="fab fa-telegram-plane me-1"></i> Telegram
    </button>
    <!-- <button class="btn-share facebook" (click)="shareTo('facebook')">
      <i class="fab fa-facebook-f me-1"></i> Facebook
    </button>
    <button class="btn-share copy-link" (click)="copyReferralLink()">
      <i class="fa fa-link me-1"></i> Copy Link
    </button> -->
  </div>
</div>

<div class="news-scroller card p-3 mt-2 shadow-sm rounded-3">
  <h5 class="mb-3 text-center text-info">Latest News</h5>

  <div class="news-container">

    <!-- FIXED TITLE BOX -->
    <div class="fixed-title">
      <h6>{{ currentNews?.news_title }}</h6>
    </div>

    <!-- AUTO SCROLL CONTENT BOX -->
    <div class="scroll-box" #scrollBox (scroll)="onManualScroll()">
      <p>{{ currentNews?.news }}</p>
    </div>

  </div>
</div>



   <button type="button" class="btn btn-success" *ngIf="pfdata?.regid === '115599'" routerLink="/cpdashboard">  Company Dashboard </button>

   <section class="container">
  <div *ngIf="pfdata?.regid === '899846'" >
        <app-search-userdata-employee></app-search-userdata-employee>
   </div>
  </section>

  <!-- Wallet Cards -->
  <section class="stats-grid">
    <div class="stat-card gradient-blue">
      <h5>Wallet Balance</h5>
      <h3>{{ pfdata?.walletamount | currency:'USD':true:'1.2-2' }}</h3>
    </div>

    <div class="stat-card gradient-purple">
      <h5>Activation Fund</h5>
      <h3>{{ pfdata?.actwallet | currency:'USD':true:'1.2-2' }}</h3>
    </div>

    <div class="stat-card gradient-green" routerLink="/myreferrals">
      <h5>Referral Users</h5>
      <h3>{{ hdata?.sponsors }}</h3>
    </div>

    <div class="stat-card gradient-orange">
      <h5>Referral Earnings</h5>
      <h3>{{ hdata?.referalincome | currency:'USD':true:'1.2-2' }}</h3>
    </div>
  </section>

  <!-- Additional Info -->
  <section class="extra-grid">
    <div class="extra-card gradient-cyan">
      <h5>Rebirth IDs</h5>
      <h3>{{ pfdata?.autocount }}</h3>
    </div>

    <div class="extra-card gradient-pink">
      <h5>Team Count</h5>
      <h3>{{ totalMembers }}</h3>
    </div>

    <div class="extra-card gradient-referal">
      <h5>Board Income</h5>
      <h3> {{ hdata?.boardincome | currency:'USD':true:'1.2-2' }}</h3>
    </div>

     <div class="stat-card gradient-royal">
      <h5>Royalty Earning</h5>
      <h3>{{ hdata?.royalincome | currency:'USD':true:'1.2-2' }}</h3>
    </div>

     <div class="extra-card gradient-level">
      <h5>Level Income</h5>
      <h3>{{ hdata?.levelincome | currency:'USD':true:'1.2-2' }}</h3>
    </div>

       <div class="extra-card gradient-level">
      <h5>Staking Coins</h5>
      <h3>{{ pfdata?.stakingcoins || 0}}</h3>
    </div>
  </section>

<section>
  <div class="text-center">
    <button class="btn btn-primary" (click)="openRoyaltyModal()">Royalty View</button>
  </div>
</section>


  <!-- <app-board1></app-board1> -->
<div class="board-display mt-4">
    <app-board1 *ngIf="selectedBoard === 1"></app-board1>
    <app-board2 *ngIf="selectedBoard === 2"></app-board2>
    <app-board3 *ngIf="selectedBoard === 3"></app-board3>
    <app-board4 *ngIf="selectedBoard === 4"></app-board4>
    <app-board5 *ngIf="selectedBoard === 5"></app-board5>
    <app-board6 *ngIf="selectedBoard === 6"></app-board6>
    <app-board7 *ngIf="selectedBoard === 7"></app-board7>
    <app-board8 *ngIf="selectedBoard === 8"></app-board8>
    <app-board9 *ngIf="selectedBoard === 9"></app-board9>
    <app-board10 *ngIf="selectedBoard === 10"></app-board10>
    <app-board11 *ngIf="selectedBoard === 11"></app-board11>
    <app-board12 *ngIf="selectedBoard === 12"></app-board12>
    <app-board13 *ngIf="selectedBoard === 13"></app-board13>
    <app-board14 *ngIf="selectedBoard === 14"></app-board14>
    <app-board15 *ngIf="selectedBoard === 15"></app-board15>
  </div>
  <!-- Board Status -->
  <section class="board-section">
  <h4>Board Status</h4>

  <!-- Board grid selector -->
  <div class="board-grid">
    <div
      *ngFor="let board of boards"
      class="board-card"
      [class.active]="board.id === selectedBoard"
      (click)="selectBoard(board.id)"
    >
      <span>{{ board.name }} </span>
      <!-- <small>{{ board.status }}</small> -->
    </div>
  </div>

  <!-- Display selected board component -->
  
</section>

<!-- Royalty View Modal -->
<div class="modal fade" id="royaltyModal" tabindex="-1" aria-labelledby="royaltyModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered modal-lg">
    <div class="modal-content">
      <div class="modal-header bg-primary text-white">
        <h5 class="modal-title" id="royaltyModalLabel">Royalty View (Level Summary)</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      
      <div class="modal-body">
        <table class="table table-bordered text-center">
          <thead class="table-dark">
            <tr>
              <th>S.No</th>
              <th>Rank</th>
              <th>Level</th>
              <th>Count</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let lvl of levelCounts.slice(0, 4); let i = index">
              <td>{{ i + 1 }}</td>
              <td>
                {{
                  lvl.level === 1 ? 'Starter' :
                  lvl.level === 2 ? 'Leader' :
                  lvl.level === 3 ? 'Elite' :
                  lvl.level === 4 ? 'Legend' :
                  'N/A'
                }}
              </td>
              <td>Level {{ lvl.level }}</td>
              <td>{{ lvl.count }}</td>
            </tr>
          </tbody>
        </table>
      </div>

      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
      </div>
    </div>
  </div>
</div>

<!-- securepin update modal -->

<div #securePinModal class="modal fade" tabindex="-1">
  <div class="modal-dialog modal-dialog-centered">
    <div class="modal-content">
      <div class="modal-header bg-primary text-white">
        <h5 class="modal-title">Setup Secure PIN</h5>
      </div>
      <div class="modal-body">
        <form [formGroup]="securePinForm">
          <div class="form-group mb-3">
            <label for="securepin">Enter New Secure PIN</label>
            <input type="text"
                   id="securepin"
                   class="form-control text-center fw-bold"
                   maxlength="4"
                   formControlName="securepin"
                   placeholder="Enter 4-digit PIN"
                   (input)="onPinInput($event)" />
            <small class="text-muted">
              This PIN is required for Profile Update & Wallet Transfers.
            </small>
            <div *ngIf="securePinForm.get('securepin')?.invalid && securePinForm.get('securepin')?.touched" class="text-danger small mt-1">
              Please enter exactly 4 digits.
            </div>
          </div>
        </form>
      </div>
      <div class="modal-footer">
        <button class="btn btn-success" (click)="updateSecurePin()" [disabled]="securePinForm.invalid">Save PIN</button>
      </div>
    </div>
  </div>
</div>


 <div #messageModal class="modal fade" tabindex="-1">
  <div class="modal-dialog modal-dialog-centered">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title text-danger">Notice</h5>
        <button type="button" class="btn-close" aria-label="Close" data-bs-dismiss="modal"></button>
      </div>
      <div class="modal-body text-success">
        <p>{{ modalMessage }}</p>
      </div>
      <div class="modal-footer">
        <button class="btn btn-primary" data-bs-dismiss="modal">OK</button>
      </div>
    </div>
  </div>
</div>

<!-- OFFER POPUP MODAL -->
<div #offerModal class="modal fade" tabindex="-1">
  <div class="modal-dialog modal-dialog-centered">
    <div class="modal-content p-0 border-0 shadow rounded overflow-hidden">
      
      <button type="button" class="btn-close position-absolute end-0 m-2 bg-white p-2 rounded-circle"
              data-bs-dismiss="modal"></button>

      <img src="assets/offer.jpeg" class="img-fluid w-100" alt="Special Offer">
    </div>
  </div>
</div>


</div>



<!-- Footer Navigation -->
<app-footer></app-footer>
